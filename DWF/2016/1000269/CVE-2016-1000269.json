{"description": [{"lang": "eng","value": "thoughtbot's Clearance version 1.14.2 and earlier has a possible Information Disclosure vulnerability in the password reset component which could allow an attacker to to access a user's password reset token and gain access to the user's account. "}],"assigner": "kurt@seifried.org","problem_types": [{"description": [{"lang": "eng","value": "information disclosure"}]}],"references": [{"url": "https://github.com/thoughtbot/clearance/pull/707"}],"requester": "derek@thoughtbot.com","serial": "1","date_assigned": "2016-12-13T20:42:26.093666","date_requested": "9/26/2016 19:31:44","cve_id": "CVE-2016-1000269","notes": [{"lang": "eng","value": "The password reset token is included in the URL emailed to users who\nrequest a password reset. When the user clicks the link, they are\nbrought to the password reset form. If instead of completing the form\nthe user clicks a link to another HTTPS resource that may be in the site\nnavigation, then the password reset token will be leaked to that\nexternal site via HTTP referer (sic).\n\nTaking advantage of this would require an attacker to:\n* Control an external site that is linked to on the password reset token\n* Capture any HTTP referers that contain the token\n* Use the referer URL to complete the password reset before the user does so themselves.\n\nIn Clearance 1.15.0, the password reset component was updated to remove the password reset token from the URL when the form is displayed. This means the token will not be leaked in the referer.\n\nDevelopers that have customized the `Clearance::PasswordsController#edit` action or `Clearance::PasswordController#find_user_for_edit` without calling `super` may have to apply a fix similar to that which was applied in 1.15.0 themselves."}],"data_format": "MITRE","data_version": "3.1","state": "PUBLIC","products": [{"product": [{"version": "1.14.2 and earlier","product_name": "Clearance"},{"affects": "FIXED","version": "1.15.0","product_name": "Clearance"}],"vendor_name": "thoughtbot"}]}