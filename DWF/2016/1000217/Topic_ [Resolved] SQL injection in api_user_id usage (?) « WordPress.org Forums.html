<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head profile="http://gmpg.org/xfn/11">
<meta charset="utf-8" />
<!--
<meta property="fb:page_id" content="6427302910" />
-->
<meta name="google-site-verification" content="7VWES_-rcHBcmaQis9mSYamPfNwE03f4vyTj4pfuAw0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="noodp">
<title>Topic: [Resolved] SQL injection in api_user_id usage (?) &laquo;  WordPress.org Forums</title>
<meta name="referrer" content="always">
<link href="//s.w.org/wp-includes/css/dashicons.css?20160504" rel="stylesheet" type="text/css" />
<link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,400,300,600&subset=latin,cyrillic-ext,greek-ext,greek,vietnamese,latin-ext,cyrillic' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="//s.w.org/style/wp4.css?45" />
<link media="only screen and (max-device-width: 480px)" href="//s.w.org/style/iphone.css?1" type="text/css" rel="stylesheet" />
<link rel="shortcut icon" href="//s.w.org/favicon.ico?2" type="image/x-icon" />

<script type="text/javascript">
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-52447-1']);
_gaq.push(['_setDomainName', 'wordpress.org']);
_gaq.push(['_trackPageview']);
(function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
function recordOutboundLink(link, category, action) {
	_gaq.push(['_trackEvent', category, action])
	setTimeout('document.location = "' + link.href + '"', 100);
}
</script>
<!--[if lte IE 8]>
<style type="text/css">
@import url("//s.w.org/style/ie.css?1");
</style>
<![endif]-->
<link rel="pingback" href="https://wordpress.org/support/xmlrpc.php" /><link rel='dns-prefetch' href='//s.w.org' />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/wordpress.org\/support\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7-alpha-38583"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),h.toDataURL().length<3e3?!1:(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='bbp-default-css'  href='https://wordpress.org/support/wp-content/plugins/bbpress/templates/default/css/bbpress.min.css?ver=2.6-alpha-5566' type='text/css' media='screen' />
<link rel='stylesheet' id='bb-base-css'  href='//bbpress.org/wp-content/themes/bb-base/style.css?ver=20150216d' type='text/css' media='all' />
<link rel='stylesheet' id='forum-wp4-style-css'  href='https://wordpress.org/support/wp-content/themes/pub/wporg-forums/style.css?ver=20160906' type='text/css' media='all' />
<script type='text/javascript' src='https://wordpress.org/support/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://wordpress.org/support/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<link rel='https://api.w.org/' href='https://wordpress.org/support/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://wordpress.org/support/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://wordpress.org/support/wp-includes/wlwmanifest.xml" /> 
<meta name="generator" content="WordPress 4.7-alpha-38583" />
<link rel="canonical" href="https://wordpress.org/support/topic/sql-injection-in-api_user_id/" />
<link rel='shortlink' href='https://wordpress.org/support/?p=7337605' />
<script>document.cookie='devicePixelRatio='+((window.devicePixelRatio === undefined) ? 1 : window.devicePixelRatio)+'; path=/';</script>
<script type="text/javascript">
var toggleMenu = function(){
    var m = document.getElementById('wporg-header-menu'),
        c = m.className;
	    m.className = c.match( ' active' ) ? c.replace( ' active', '' ) : c + ' active';
}
</script>

</head>

<body id="wordpress-org" class="topic bbpress single single-topic postid-7337605 wporg-responsive wporg-support">
<div id="wporg-header">
	<div class="wrapper">
		<a id="mobile-menu-button" class="" href="#" onclick="toggleMenu();"></a>
	<h1><a href="//wordpress.org">WordPress.org</a></h1>				<div id="head-search">
		<form action="//wordpress.org/search/do-search.php" method="get">
			<label for="global-search" class="screen-reader-text">Search WordPress.org for:</label>
			<input id="global-search" class="text" name="search" type="text" value="" maxlength="150" placeholder="Search WordPress.org" /> <input type="submit" class="button" value="" />
		</form>
		</div>
				<div style="clear:both"></div>
		
<ul id="wporg-header-menu">
<li><a href='//wordpress.org/showcase/' title='See some of the sites built on WordPress.'>Showcase</a></li>
<li><a href='//wordpress.org/themes/' title='Find just the right look for your website.'>Themes</a></li>
<li><a href='//wordpress.org/plugins/' title='Plugins can extend WordPress to do almost anything you can imagine.'>Plugins</a></li>
<li><a href='//wordpress.org/mobile/' title='Take your website on the go!'>Mobile</a></li>
<li><a href='//wordpress.org/support/' title='Forums, documentation, help.' class="current">Support</a><ul class="nav-submenu"><li><a href='//wordpress.org/support/' title='Support and discussion forums.'>Forums</a></li><li><a href='//codex.wordpress.org/Main_Page' title='Documentation, tutorials, best practices.'>Documentation</a></li></ul><div class="uparrow"></div></li>
<li><a href='//make.wordpress.org/' title='Contribute your knowledge.'>Get Involved</a></li>
<li><a href='//wordpress.org/about/' title='About the WordPress Organization, and where we&#039;re going.'>About</a></li>
<li><a href='//wordpress.org/news/' title='Come here for the latest scoop.'>Blog</a></li>
<li><a href='//wordpress.org/hosting/' title='Find a home for your blog.'>Hosting</a></li>
<li id="download" class="button download-button"><a href='//wordpress.org/download/' title='Get it. Got it? Good.'>Download WordPress</a></li>
</ul>
		<div style="clear:both"></div>
	</div>
</div>



<div id="headline">
	<div class="wrapper">
		<h2><a href="https://wordpress.org/support/">Forums</a></h2>
		<p class="login">
											<a href="https://login.wordpress.org/?redirect_to=https%3A%2F%2Fwordpress.org%2Fsupport%2Ftopic%2Fsql-injection-in-api_user_id%2F">Log In</a>
					</p>
	</div>
</div>

<div id="pagebody">
	<div class="wrapper">
		<div class="col-12">
			<div class="content">
				
					
<div id="bbpress-forums">

	<h2>[Resolved] SQL injection in api_user_id usage (?)</h2>

	
	
		
			

<ul id="bbp-topic-7337605-lead" class="bbp-lead-topic">

	<li class="bbp-body">

		<div id="post-7337605" class="even bbp-parent-forum-21262 user-id-14948051 post-7337605 topic type-topic status-publish hentry topic-tag-api_user_id">

			<div class="bbp-topic-author">

				
				<a href="https://wordpress.org/support/users/uberspot/" title="View uberspot&#039;s profile" class="bbp-author-avatar" rel="nofollow"><img alt='' src='https://secure.gravatar.com/avatar/ede194ad58e859be764905ea4f120bda?s=80&#038;d=retro&#038;r=g' srcset='https://secure.gravatar.com/avatar/ede194ad58e859be764905ea4f120bda?s=160&amp;d=retro&amp;r=g 2x' class='avatar avatar-80 photo' height='80' width='80' /></a><br /><a href="https://wordpress.org/support/users/uberspot/" title="View uberspot&#039;s profile" class="bbp-author-name" rel="nofollow">uberspot</a><br /><div class="bbp-author-role">Member</div>
				<p class="bbp-user-nicename">@uberspot</p>
				<p class="bbp-topic-post-date"><a href="https://wordpress.org/support/topic/sql-injection-in-api_user_id/" title="#7337605" class="bbp-topic-permalink">4 months, 1 week ago</a></p>

				
				
			</div><!-- .bbp-topic-author -->

			<div class="bbp-topic-content">

				
				<p>Hi,</p>
<p>in <code>lib/shortcode/shortcode.ajax.php</code><br />
you get the api_user_id from the GET parameter.</p>
<pre><code>function Zotpress_shortcode_AJAX() {
    ...
    $zp_api_user_id = $_GET[&#039;api_user_id&#039;];
    ...
    $zp_account = zp_get_account ($wpdb, $zp_api_user_id);</code></pre>
<p>You then use that api_user_id in the functions <code>zp_get_account</code>, <code>zp_get_accounts</code> and <code>zp_clear_cache_for_user</code> in <code>lib/request/request.function.php</code> which do SQL queries with the <code>wpdb-&gt;get_results</code> function but don&#8217;t do <code>wpdb-&gt;prepare</code> on the input.</p>
<pre><code>function zp_get_account ($wpdb, $api_user_id_incoming=false)
{
    if ($api_user_id_incoming !== false)
        $zp_account = $wpdb-&gt;get_results(&quot;SELECT * FROM
&quot;.$wpdb-&gt;prefix.&quot;zotpress WHERE api_user_id=&#039;&quot;.$api_user
_id_incoming.&quot;&#039;&quot;);</code></pre>
<p>I might be mistaken but with a brief glimpse I don&#8217;t see where the api_user_id is validated/sanitized in which case there is an sql injection vulnerability. Am I missing something? Is some wordpress function escaping that user input?</p>
<p>Helpful resources:<br />
<a href="https://developer.wordpress.org/plugins/security/securing-input/" rel="nofollow">https://developer.wordpress.org/plugins/security/securing-input/</a><br />
<a href="http://ottopress.com/2013/better-know-a-vulnerability-sql-injection/" rel="nofollow">http://ottopress.com/2013/better-know-a-vulnerability-sql-injection/</a></p>
<p><a href="https://wordpress.org/plugins/zotpress/" rel="nofollow">https://wordpress.org/plugins/zotpress/</a></p>

				
			</div><!-- .bbp-topic-content -->

			<span class="bbp-admin-links"></span>
		</div><!-- #post-7337605 -->

	</li><!-- .bbp-body -->

</ul><!-- #topic-7337605-replies -->


		
		
			
<div class="bbp-pagination">
	<div class="bbp-pagination-count">Viewing 1 replies (of 1 total)</div>
	<div class="bbp-pagination-links"></div>
</div>


			
<ul id="topic-7337605-replies" class="forums bbp-replies">

	<li class="bbp-body">

		
			
<div id="post-7338041" class="odd bbp-parent-forum-21262 bbp-parent-topic-7337605 bbp-reply-position-1 user-id-7583585 post-7338041 reply type-reply status-publish hentry by-plugin-author">

	<div class="bbp-reply-author">

		<span class="author-badge plugin-author-badge" title="This person is the author of this plugin">Plugin Author</span>
		<a href="https://wordpress.org/support/users/kseaborn/" title="View Katie&#039;s profile" class="bbp-author-avatar" rel="nofollow"><img alt='' src='https://secure.gravatar.com/avatar/94cc622ae6b78b0bf79f75f917288c2e?s=100&#038;d=retro&#038;r=g' srcset='https://secure.gravatar.com/avatar/94cc622ae6b78b0bf79f75f917288c2e?s=200&amp;d=retro&amp;r=g 2x' class='avatar avatar-100 photo' height='100' width='100' /></a><br /><a href="https://wordpress.org/support/users/kseaborn/" title="View Katie&#039;s profile" class="bbp-author-name" rel="nofollow">Katie</a><br /><div class="bbp-author-role">Member</div>
		<p class="bbp-user-nicename">@kseaborn</p>
		<p class="bbp-reply-post-date"><a href="https://wordpress.org/support/topic/sql-injection-in-api_user_id/#post-7338041" title="#7338041" class="bbp-reply-permalink">3 months ago</a></p>

		
		
	</div><!-- .bbp-reply-author -->

	<div class="bbp-reply-content">

		
		<p>Nice catch. This will be fixed in 6.1.3.</p>

		
	</div><!-- .bbp-reply-content -->

	<span class="bbp-admin-links"></span>
</div><!-- #post-7338041 -->

		
	</li><!-- .bbp-body -->

</ul><!-- #topic-7337605-replies -->


			
<div class="bbp-pagination">
	<div class="bbp-pagination-count">Viewing 1 replies (of 1 total)</div>
	<div class="bbp-pagination-links"></div>
</div>


		
		

	<div id="no-reply-7337605" class="bbp-no-reply">
		<div class="bbp-template-notice">
			<ul>
				<li>You must be logged in to reply to this topic.</li>
			</ul>
		</div>
	</div>



	
	
</div>

							</div>

			<div class="sidebar">

	
		
					<div>
			<h3>About this Plugin</h3>
			<ul>
				<li><style type='text/css'>#plugin-icon-zotpress { width:128px; height:128px; background-image: url(//ps.w.org/zotpress/assets/icon-128x128.png?rev=1043853); background-size:128px 128px; }</style><div class='plugin-icon' id='plugin-icon-zotpress' style='float:left; margin: 3px 6px 6px 0px;'></div></li>
				<li style="clear:both;"><a href="//wordpress.org/plugins/zotpress/">Zotpress</a></li>
								<li><a href="//wordpress.org/plugins/zotpress/faq/">Frequently Asked Questions</a></li>
								<li><a href="//wordpress.org/support/plugin/zotpress/">Support Threads</a></li>
				<li><a href="//wordpress.org/support/plugin/zotpress/reviews/">Reviews</a></li>
			</ul>
		</div>
		
			<div>
				<h3>Topic Info</h3>
				<ul class="topic-info">
					
	<li class="topic-forum">In: <a href="https://wordpress.org/support/forum/plugins-and-hacks/">Plugins and Hacks</a></li>
	<li class="reply-count">1 reply</li>	<li class="voice-count">2 participants</li>			<li class="topic-freshness-author">Last reply from: <a href="https://wordpress.org/support/users/kseaborn/" title="View Katie&#039;s profile" class="bbp-author-name" rel="nofollow">Katie</a></li>
		<li class="topic-freshness-time">Last activity: <a href="https://wordpress.org/support/topic/sql-injection-in-api_user_id/#post-7338041" title="Reply To: [Resolved] SQL injection in api_user_id usage (?)">3 months ago</a></li>				<li class="wp-version">4.5.1</li>
							<li class="topic-resolved">Status: resolved</li>
			
					</ul>
			</div>

			<div>
				<h3>Topic Tags</h3><ul class="topic-tags"><li><a href="https://wordpress.org/support/topic-tag/api_user_id/" rel="tag">api_user_id</a></li></ul>			</div>

			<div>
				
	<form role="search" method="get" id="searchform" action="https://wordpress.org/search/do-search.php">
		<div>
			<h3>Forum Search</h3>
			<label class="screen-reader-text hidden" for="search">Search for:</label>
			<input name="search" class="text" id="forumsearchbox" value type="text" />
			<input name="go" class="button" type="submit" id="searchsubmit" value="Search" />
			<input value="1" name="forums" type="hidden">
		</div>
	</form>

			</div>

			
		
	
</div>
		</div>

	</div>
</div>


<div id="wporg-footer">
		<div class="wrapper">
		<ul>
			<li><a href="//wordpress.org/about/" title="An introduction to the WordPress project">About</a></li>
			<li><a href="//wordpress.org/news/" title="News and Updates">Blog</a></li>
			<li><a href="//wordpress.org/hosting/" title="Recommended web hosting providers">Hosting</a></li>
			<li><a href="http://jobs.wordpress.net/" title="Find or post WordPress jobs">Jobs</a></li>
		</ul>

		<ul>
			<li><a href="//wordpress.org/support/" title="Forums, documentation, and other resources">Support</a></li>
			<li><a href="//developer.wordpress.org" title="Resources for WordPress developers">Developers</a></li>
			<li><a href="//make.wordpress.org/" title="Give back to WordPress through code, support, translation and more">Get Involved</a></li>
			<li><a href="//learn.wordpress.org/" title="Workshops and training materials">Learn</a></li>
		</ul>

		<ul>
			<li><a href="//wordpress.org/showcase/" title="Some of the best WordPress sites on the Web">Showcase</a></li>
			<li><a href="//wordpress.org/plugins/" title="Add extra functionality to WordPress">Plugins</a></li>
			<li><a href="//wordpress.org/themes/" title="Make your WordPress pretty">Themes</a></li>
			<li><a href="//wordpress.org/ideas/" title="Share your ideas for improving WordPress">Ideas</a></li>
		</ul>

		<ul>
			<li><a href="//central.wordcamp.org/" title="Find a WordPress event near you">WordCamp</a></li>
			<li><a href="//wordpress.tv/" title="Videos, tutorials, and WordCamp sessions">WordPress.TV</a></li>
			<li><a href="//buddypress.org/" title="A set of plugins to transform your WordPress into a social network">BuddyPress</a></li>
			<li><a href="//bbpress.org/" title="Fast, slick forums built on WordPress">bbPress</a></li>
		</ul>

		<ul>
			<li><a href="//wordpress.com/?ref=wporg-footer" title="Hassle-free WordPress hosting">WordPress.com</a></li>
			<li><a href="//ma.tt/" title="Co-founder of WordPress, an example of what WordPress can do">Matt</a></li>
			<li><a href="//wordpress.org/about/privacy/" title="WordPress.org Privacy Policy">Privacy</a></li>
			<li><a href="//wordpress.org/about/license/" title="WordPress is open source software">License / GPLv2</a></li>
		</ul>

		<ul>
			<li>
				<iframe title="Follow @WordPress on Twitter" allowtransparency="true" frameborder="0" scrolling="no" src="//platform.twitter.com/widgets/follow_button.html?screen_name=WordPress&amp;show_count=false" style="width:135px; height:20px;"></iframe>
			</li>
			<li>
				<iframe title="Like WordPress on Facebook" src="//www.facebook.com/plugins/like.php?app_id=121415197926116&amp;href=http%3A%2F%2Fwww.facebook.com%2Fwordpress&amp;send=false&amp;layout=button_count&amp;width=135&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font=lucida+grande&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:135px; height:21px;" allowTransparency="true"></iframe>
			</li>
			<li>
				<script src="https://apis.google.com/js/platform.js" async defer></script>
				<div class="g-plusone" data-size="medium" data-href="https://plus.google.com/+WordPress"></div>
			</li>
		</ul>
	</div>
	
		<h6 class="aligncenter cip-image">Code is Poetry.</h6>
</div>


<script type="text/javascript">
  var _qevents = _qevents || [];
  (function() {
   var elem = document.createElement('script');
   elem.src = (document.location.protocol == "https:" ? "https://secure" : "http://edge")
               + ".quantserve.com/quant.js";
   elem.async = true;
   elem.type = "text/javascript";
   var scpt = document.getElementsByTagName('script')[0];
   scpt.parentNode.insertBefore(elem, scpt);
  })();
</script>
<script type="text/javascript">_qevents.push( { qacct:"p-18-mFEk4J448M"} );</script>
<noscript><img src="//pixel.quantserve.com/pixel/p-18-mFEk4J448M.gif" style="display: none;" border="0" height="1" width="1" alt=""/></noscript>
<!-- 5 queries. 0.159 seconds -->
<script type="text/javascript" src="//gravatar.com/js/gprofiles.js"></script>

<script type="text/javascript">
(function($){
$(document).ready(function() {
	$('#footer a').click(function() {
		if (this.href.indexOf('wordpress.org') == -1 && this.href.indexOf('http') == 0) {
			recordOutboundLink(this, 'Outbound Links', this.href);
			return false;
		}
	});
});
})(jQuery);
</script>
<script type='text/javascript' src='https://wordpress.org/support/wp-content/plugins/wporg-bbp-version-dropdown/wporg-bbp-version-dropdown.js?ver=20160729'></script>
<script type='text/javascript' src='https://wordpress.org/support/wp-content/plugins/bbpress/templates/default/js/editor.min.js?ver=2.6-alpha-5566'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var bbpTopicJS = {"bbp_ajaxurl":"https:\/\/wordpress.org\/support\/topic\/sql-injection-in-api_user_id\/?bbp-ajax=true","generic_ajax_error":"Something went wrong. Refresh your browser and try again.","is_user_logged_in":"","fav_nonce":"418806196e","subs_nonce":"7c2813e85d"};
/* ]]> */
</script>
<script type='text/javascript' src='https://wordpress.org/support/wp-content/plugins/bbpress/templates/default/js/topic.min.js?ver=2.6-alpha-5566'></script>
<script type='text/javascript' src='https://wordpress.org/support/wp-includes/js/wp-embed.min.js?ver=4.7-alpha-38583'></script>
</body>
</html>
